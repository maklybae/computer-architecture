# –ò–î–ó-2. –í–∞—Ä–∏–∞–Ω—Ç 19

*–ö–ª—ã—á–∫–æ–≤ –ú–∞–∫—Å–∏–º –î–º–∏—Ç—Ä–∏–µ–≤–∏—á –ë–ü–ò237*

ü§ú[–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ –≤—Å–µ–º–∏ –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏](program/)ü§õ

ü´±[–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã](program/main.asm)ü´≤

ü´∏[–¢–µ—Å—Ç–∏—Ä—É—é—â–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞](program/tests.asm)ü´∑

- [–ò–î–ó-2. –í–∞—Ä–∏–∞–Ω—Ç 19](#–∏–¥–∑-2-–≤–∞—Ä–∏–∞–Ω—Ç-19)
  - [–ó–∞–¥–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞](#–∑–∞–¥–∞–Ω–∏–µ-–≤–∞—Ä–∏–∞–Ω—Ç–∞)
  - [–û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏](#–æ–ø–∏—Å–∞–Ω–∏–µ-–º–µ—Ç–æ–¥–∞-—Ä–µ—à–µ–Ω–∏—è-–∑–∞–¥–∞—á–∏-–∏-–∏—Å—Ç–æ—á–Ω–∏–∫–∏)
  - [4-5 –±–∞–ª–ª–æ–≤](#4-5-–±–∞–ª–ª–æ–≤)
  - [6-7 –±–∞–ª–ª–æ–≤](#6-7-–±–∞–ª–ª–æ–≤)
  - [8 –±–∞–ª–ª–æ–≤](#8-–±–∞–ª–ª–æ–≤)
    - [–ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º](#–º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º)
    - [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è-—Ç–µ—Å—Ç–æ–≤–∞—è-–ø—Ä–æ–≥—Ä–∞–º–º–∞)
    - [–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ `Python`](#–ø—Ä–æ–≤–µ—Ä–∫–∞-–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏-–≤—ã—á–∏—Å–ª–µ–Ω–∏–π-–Ω–∞-python)
  - [9 –±–∞–ª–ª–æ–≤](#9-–±–∞–ª–ª–æ–≤)
    - [–ú–∞–∫—Ä–æ—Å—ã-–æ–±–µ—Ä—Ç–∫–∏](#–º–∞–∫—Ä–æ—Å—ã-–æ–±–µ—Ä—Ç–∫–∏)
    - [–î—Ä—É–≥–∏–µ –º–∞–∫—Ä–æ—Å—ã](#–¥—Ä—É–≥–∏–µ-–º–∞–∫—Ä–æ—Å—ã)
  - [10 –±–∞–ª–ª–æ–≤](#10-–±–∞–ª–ª–æ–≤)
    - [–†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤](#—Ä–∞–∑–±–∏–µ–Ω–∏–µ-–Ω–∞-–Ω–µ—Å–∫–æ–ª—å–∫–æ-–∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã—Ö-—Ñ–∞–π–ª–æ–≤)
    - [–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –º–∞–∫—Ä–æ—Å–æ–≤](#–±–∏–±–ª–∏–æ—Ç–µ–∫–∞-–º–∞–∫—Ä–æ—Å–æ–≤)


## –ó–∞–¥–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞

> –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—Ä–Ω—è –∫—É–±–∏—á–µ—Å–∫–æ–≥–æ –∏–∑ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –±—ã—Å—Ç—Ä–æ —Å—Ö–æ–¥—è—â–µ–º—É—Å—è –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ—Ä–Ω—è n-–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –Ω–µ —Ö—É–∂–µ 0,05%.

## –û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

–î–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫—É–±–∏—á–µ—Å–∫–æ–≥–æ –∫–æ—Ä–Ω—è –∏–∑ —á–∏—Å–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [–º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%9D%D1%8C%D1%8E%D1%82%D0%BE%D0%BD%D0%B0).

–î–ª—è –∏–∑—É—á–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏:
- [–í–∏–∫–∏–ø–µ–¥–∏—è](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%9D%D1%8C%D1%8E%D1%82%D0%BE%D0%BD%D0%B0)
- [StudFiles](https://studfile.net/preview/7071534/page:31/)

## 4-5 –±–∞–ª–ª–æ–≤

–†–∞—Å–ø–∏—à–µ–º –∫–∞–∂–¥–æ–µ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π, –¥–æ–ø–æ–ª–Ω–∏–≤ –∏—Ö –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏.

–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã. –ü—Ä–∏–≤–µ–¥–µ–Ω–Ω–∞—è –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ `read_x` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–≤–µ—Å—Ç–∏ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ, –∫—É–±–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–µ–Ω—å –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã –Ω–∞–π–¥–µ–º –¥–∞–ª–µ–µ.

![read_x](static/read_x.png)

–í—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∏—Å–ø–ª–µ–π —Ç–∞–∫–∂–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã `print_root_x`:

![print_root_x](static/print_root_x.png)

–í –ø—Ä–æ–≥—Ä–∞–º–º–µ —Ç–∞–∫–∂–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –ø–æ—è—Å–Ω—è—é—â–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–º –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤.

|       $x$        | $\sqrt[3]{x}$ |            screenshot             |
| :--------------: | :-----------: | :-------------------------------: |
|       $0$        |    $0.000$    |  ![1](static/stupid_tests/1.png)  |
|       $1$        |    $1.000$    |  ![2](static/stupid_tests/2.png)  |
|       $-1$       |   $-1.000$    |  ![3](static/stupid_tests/3.png)  |
|      $1000$      |   $10.000$    |  ![4](static/stupid_tests/4.png)  |
|     $-1000$      |   $-10.000$   |  ![5](static/stupid_tests/5.png)  |
|     $0.027$      |    $0.300$    |  ![6](static/stupid_tests/6.png)  |
|     $-0.027$     |   $-0.300$    |  ![7](static/stupid_tests/7.png)  |
|   $1.23456789$   |   $1.0728$    |  ![8](static/stupid_tests/8.png)  |
|  $-1.23456789$   |   $-1.0728$   |  ![9](static/stupid_tests/9.png)  |
| $123124123.123$  |   $497.486$   | ![10](static/stupid_tests/10.png) |
| $-123124123.123$ |  $-497.486$   | ![11](static/stupid_tests/11.png) |

## 6-7 –±–∞–ª–ª–æ–≤

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è –∫—Ä–∏—Ç–µ—Ä–∏–∏, –∫–∞—Å–∞—é—â–∏–µ—Å—è –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º –∏ –∏—Ö –≤—ã–∑–æ–≤–æ–≤, –ø–æ—ç—Ç–æ–º—É –æ—Ç–¥–µ–ª—å–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—É—é –∏–∑ –Ω–∏—Ö, –ø–æ–∫–∞–∑–∞–≤, —á—Ç–æ –≤—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è.

- –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ `cube_root`:

```
cube_root:
	# y = x  # –ù–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ
  # while True:
  #     y_next = (2 * y + x / (y ** 2)) / 3
  #     # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
  #     if abs(y_next - y) / y_next < tolerance:
  #         return y_next
  #     y = y_next
  
  # variables mapping
	# fs1 <-> x
	# fs2 <-> y
	# fs3 <-> y_next
	# fs4 <-> tolerance
	# s1 <-> sign of x

	# add to stack (also ret address)
	addi sp, sp, -40
	fsd fs1, 32(sp)
	fsd fs2, 24(sp)
	fsd fs3, 16(sp)
	fsd fs4, 8(sp)
	sw s1, 4(sp)
	sw ra, 0(sp)
	
	# check for zero (ans is the same as input - zero)
	li t0, 0
	fcvt.d.w ft0, t0
	feq.d t0, fa0, ft0
	bgtz t0, cube_root_ret
	
	# store sign of x and call abs(x)
	# 0.0 is already in ft0
	flt.d s1, fa0, ft0
	jal abs
	
	# load tolerance
	fld fs4, tolerance, t0
	
	fmv.d fs1, fa0 # copy of x
	fmv.d fs2, fa0 # y
	

cube_root_loop:
	# second term
	fmv.d ft2, fs1
	fdiv.d ft2, ft2, fs2
	fdiv.d ft2, ft2, fs2
	
	# numerator
	li t0, 2
	fcvt.d.w ft0, t0
	fmadd.d fs3, ft0, fs2, ft2
	
	# y_next will be in fs3
	li t0, 3
	fcvt.d.w ft0, t0
	fdiv.d fs3, fs3, ft0
	
	# calling abs function to get abs of (y_next - y) and calculate abs(...)/y_next
	fsub.d fa0, fs3, fs2
	jal abs
	fdiv.d ft0, fa0, fs3
	
	# compare with tolerance
	fgt.d t0, ft0, fs4
	beqz t0, cube_root_prepare_ret
	fmv.d fs2, fs3
	j cube_root_loop

cube_root_prepare_ret:
	# change sign if initial x < 0
	beqz s1 cube_root_ret
	fneg.d fs3, fs3
cube_root_ret:
	fmv.d fa0, fs3
	
	fld fs1, 32(sp)
	fld fs2, 24(sp)
	fld fs3, 16(sp)
	fld fs4, 8(sp)
	lw s1, 4(sp)
	lw ra, 0(sp)
	addi sp, sp, -40
	ret
```

–í–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–∞–∫–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–µ.
–í –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∏ —Å–∞–º–æ–º –≤—Ö–æ–¥–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é —Ç–∞–∫–∂–µ –Ω–∞–ø–∏—Å–∞–Ω –∫–æ–¥ –Ω–∞ `Python`, —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–µ, —Ç–∞–∫–∂–µ –º–∞–ø–ø–∏–Ω–≥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–¥–∞ `Python` –∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤.

–í –æ—Å–Ω–æ–≤–Ω–æ–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã `s*`, –ø—Ä–∏ —ç—Ç–æ–º –≤ –Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ —Ñ—É–Ω–∫—Ü–∏–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å—Ç–µ–∫–µ, —á—Ç–æ–±—ã –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å. –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–¥—Ä–µ—Å –≤–æ–∑–≤—Ä–∞—Ç–∞ –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π.

–í—ã–∑–æ–≤ –∏–∑ `main`

![call](static/cube_root_call.png)

- –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ `abs`:

–≠—Ç–∞ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–æ–¥—É–ª—å –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞. –õ–æ–≥–∏–∫–∞ —Ç—É—Ç –ø—Ä–æ—Å—Ç–∞—è: –µ—Å–ª–∏ —á–∏—Å–ª–æ –º–µ–Ω—å—à–µ –Ω—É–ª—è, —Ç–æ –Ω—É–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –∑–Ω–∞–∫.

![abs](static/abs.png)

–í—ã–∑–æ–≤ –∏–∑ `cube_root`:

–í—Å–µ–≥–æ `abs` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞ —Ä–∞–∑–∞ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

![call](static/abs_call_1.png)

![call](static/abs_call_2.png)

- –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –≤–≤–æ–¥–∞ –∏ –≤—ã–≤–æ–¥–∞:

–≠—Ç–∏ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –≤—ã–≤–æ–¥—è—Ç —Å—Ç—Ä–æ–∫—É-–ø–æ–¥—Å–∫–∞–∑–∫—É –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç(–ø–µ—á–∞—Ç–∞—é—Ç) –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ.

![io](static/io.png)

–í—ã–∑–æ–≤ –∏–∑ `main`:

![call](static/read_x_call.png)

![call](static/print_root_x_call.png)

## 8 –±–∞–ª–ª–æ–≤

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

### –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º

–í —Ä–∞–∑–¥–µ–ª–µ [6-7 –±–∞–ª–ª–æ–≤](#6-7-–±–∞–ª–ª–æ–≤) –ø–µ—Ä–µ—á–∏—Å–ª—è–ª–∏—Å—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –≤—Å–µ —ç—Ç–∏ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∏–º–µ–Ω–Ω–æ —Å —Ç–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞

–ü–æ–ª–Ω—ã–π –∫–æ–¥ —Ç–µ—Å—Ç–∏—Ä—É—é—â–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω ü§ú[—Ç—É—Ç](program/tests.asm)ü§õ

–¢–µ—Å—Ç—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ —Å–µ–≥–º–µ–Ω—Ç–µ `.data`, —Ö—Ä–∞–Ω–∏—Ç—Å—è —á–∏—Å–ª–æ, –∫—É–±–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–µ–Ω—å –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—Ç–∏–º –±—Ä–∞—Ç—å, –∏ –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–ª—É—á–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–∞–∫—Ä–æ—Å:

```
# macro to run testcase
.macro macro_run_test(%x, %exp)
	# prompt
	la a0, s_n
	li a7, 4
	ecall
	
	# output initial x
	fld fa0, %x, t0
	li a7, 3
	ecall
	
	# newline
	li a7, 11
	li a0, '\n'
	ecall
	
	# prompt
	la a0, s_expected
	li a7, 4
	ecall
	
	# output expected
	fld fa0, %exp, t0
	li a7, 3
	ecall
	
	# newline
	li a7, 11
	li a0, '\n'
	ecall
	
	# prompt
	la a0, s_result
	li a7, 4
	ecall
	
	# run function
	fld fa0, %x, t0
	jal cube_root
	
	# output result
	li a7, 3
	ecall
	
	# newline
	li a7, 11
	li a0, '\n'
	ecall
	
	# newline
	li a7, 11
	li a0, '\n'
	ecall
.end_macro
```

–¢–µ–ø–µ—Ä—å –≤—ã–∑–æ–≤—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫:

![run_test call](static/run_test_call.png)

–í—Å–µ–≥–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ 11 —Ç–µ—Å—Ç–æ–≤, —Ç–æ—á–Ω–æ —Ç–∞–∫–∏—Ö –∂–µ, –∫–∞–∫ –∏ –ø—Ä–∏ —Ä—É—á–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏. –ü–æ–∫–∞–∂–µ–º –≤—ã–≤–æ–¥:

```
x = 0.0
expected result: 0.0
result: 0.0

x = 1.0
expected result: 1.0
result: 1.0

x = -1.0
expected result: 1.0
result: -1.0

x = 1000.0
expected result: 10.0
result: 10.000000002405413

x = -1000.0
expected result: -10.0
result: -10.000000002405413

x = 0.027
expected result: 0.3
result: 0.3000000000034121

x = -0.027
expected result: -0.3
result: -0.3000000000034121

x = 1.23456789
expected result: 1.0728
result: 1.0727661099094532

x = -1.23456789
expected result: -1.0728
result: -1.0727661099094532

x = 1.23124123123E8
expected result: 497.486
result: 497.4862191213331

x = -1.23124123123E8
expected result: -497.486
result: -497.4862191213331
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ `Python`

–ù–∞–ø–∏—à–µ–º –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ `Python`.

```python
def run_test(x, exp):
    print(f"x: {x}")
    print(f"exp: {exp}")
    print(f"result: {x**(1./3.) if 0<=x else -(-x)**(1./3.)}")
    print()

testcases = [
    (0., 0.),
    (1., 1.),
    (-1., -1.),
    (1000., 10.),
    (-1000., -10.),
    (0.027, 0.3),
    (-0.027, -0.3),
    (1.23456789, 1.0728),
    (-1.23456789, -1.0728),
    (123124123.123, 497.486),
    (-123124123.123, -497.486),
]

for testcase in testcases:
    run_test(*testcase)
```

–í—ã–≤–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã:

```
x = 0.0
exp: 0.0
result: 0.0

x = 1.0
exp: 1.0
result: 1.0

x = -1.0
exp: -1.0
result: -1.0

x = 1000.0
exp: 10.0
result: 9.999999999999998

x = -1000.0
exp: -10.0
result: -9.999999999999998

x = 0.027
exp: 0.3
result: 0.30000000000000004

x = -0.027
exp: -0.3
result: -0.30000000000000004

x = 1.23456789
exp: 1.0728
result: 1.0727659796410873

x = -1.23456789
exp: -1.0728
result: -1.0727659796410873

x = 123124123.123
exp: 497.486
result: 497.48621376812054

x = -123124123.123
exp: -497.486
result: -497.48621376812054
```

## 9 –±–∞–ª–ª–æ–≤

–ë—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–æ –Ω–∞–∑–≤–∞–Ω–∏—è –º–∞–∫—Ä–æ—Å–∞ –¥–æ–±–∞–≤–ª—è—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å `macros_`, —á—Ç–æ–±—ã –±—ã–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∏—á–∞—Ç—å –æ–±–µ—Ä—Ç–∫—É –Ω–∞–¥ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–æ–π –∏ —Å–∞–º—É –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—É, —Ç–∞–∫–∂–µ —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.

### –ú–∞–∫—Ä–æ—Å—ã-–æ–±–µ—Ä—Ç–∫–∏

![program specific macros](static/program_specific_macros.png)

–ù–∞ –∫–∞–∂–¥—É—é –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –±—ã–ª —Å–æ–∑–¥–∞–Ω –º–∞–∫—Ä–æ—Å-–æ–±–µ—Ä—Ç–∫–∞, —á—Ç–æ–±—ã –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π –±—ã–ª –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º. –≠—Ç–∏ –º–∞–∫—Ä–æ—Å—ã –ø—Ä–æ—Å—Ç–æ –∫–ª–∞–¥—É—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –Ω—É–∂–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä –∏ –∑–∞–ø—É—Å–∫–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏—é, –∑–∞—Ç–µ–º, –≤–æ–∑–º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª–∞–¥—ã–≤–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –¥—Ä—É–≥–æ–π —Ä–µ–≥–∏—Å—Ç—Ä.

–¢–∞–∫–∂–µ –∏–Ω–æ–π –≤–∏–¥ –ø—Ä–∏–Ω—è–ª –º–∞–∫—Ä–æ—Å –ø–æ –∑–∞–ø—É—Å–∫—É —Ç–µ—Å—Ç–æ–≤:

![macro_run_test](static/macro_run_test.png)

### –î—Ä—É–≥–∏–µ –º–∞–∫—Ä–æ—Å—ã

–¢–∞–∫–∂–µ –±—ã–ª–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞–∫—Ä–æ—Å–æ–≤ –¥–ª—è –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã:

```
# common macros

# read double to fa0 register
.macro macro_read_double_fa0
   li a7, 7
   ecall
.end_macro

# read double to any register
.macro read_double(%x)
   macro_read_double_fa0
   mv %x, fa0
.end_macro

# print double from fa0 register
.macro macro_print_double_fa0
	li a7, 3
	ecall
.end_macro

# print double from any register
.macro macro_print_double(%x)
	fmv.d fa0, %x
	macro_print_double_fa0
.end_macro

.macro macro_print_double_addr(%x)
	fld fa0, %x, t0
	macro_print_double_fa0
.end_macro

# load address by label to a0 and ecall 4 
.macro macro_print_str (%x)
   li a7, 4
   la a0, %x
   ecall
.end_macro

# print char %x
.macro macro_print_char(%x)
   li a7, 11
   li a0, %x
   ecall
.end_macro

# print newline
.macro macro_newline
   macro_print_char('\n')
.end_macro

# exit(0)
.macro macro_exit
    li a7, 10
    ecall
.end_macro
```

## 10 –±–∞–ª–ª–æ–≤

### –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤

- `cube_root.asm` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—É, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â—É—é –º–∞—Å—Å–∏–≤ $B$
- `iomod.asm` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ –≤–≤–æ–¥—É –≤—ã–≤–æ–¥—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- `main.asm` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—á–∫—É –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã `main`
- `tests.asm` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –º–∞–∫—Ä–æ—Å–æ–≤

–í—Å–µ –º–∞–∫—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ—Å—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –≤—ã–¥–µ–ª–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É `macrolib.asm`, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –º–æ–¥—É–ª—é, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–∞–∫—Ä–æ—Å—ã —Å –ø–æ–º–æ—â—å—é –¥–∏—Ä–µ–∫—Ç–∏–≤—ã `.include "macrolib.asm"`.